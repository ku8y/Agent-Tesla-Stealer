# Agent Tesla Deobfuscation & Code Recovery
![Agent Tesla Overview](agent-tesla.png)

## 1. Overview

λ³Έ μ €μ¥μ†λ” **Agent Tesla** μ•…μ„±μ½”λ“λ¥Ό λ€μƒμΌλ΅ ν•  
**μ•…μ„±μ½”λ“ λ¶„μ„ λ° λ‚λ…ν™” ν•΄μ (Deobfuscation) μ—°κµ¬ ν”„λ΅μ νΈ**μ…λ‹λ‹¤.

Agent Teslaλ” 2014λ…„μ— μ²μ λ“±μ¥ν• .NET κΈ°λ° μΈν¬μ¤ν‹Έλ¬(Infostealer) μ•…μ„±μ½”λ“λ΅,  
ν„μ¬κΉμ§€λ„ λ‹¤μ–‘ν• λ³€μΆ…μ΄ μ§€μ†μ μΌλ΅ μ ν¬λκ³  μλ” λ€ν‘μ μΈ μ •λ³΄ νƒμ·¨ν• μ•…μ„±μ½”λ“μ…λ‹λ‹¤.

λ³Έ ν”„λ΅μ νΈλ” μ‹¤μ  μ•…μ„± ν–‰μ„λ¥Ό λ©μ μΌλ΅ ν•μ§€ μ•μΌλ©°,  
**μ•…μ„±μ½”λ“ λ¶„μ„ μ—­λ‰ ν–¥μƒκ³Ό λ³΄μ• μ—°κµ¬ λ©μ **μΌλ΅ μν–‰λμ—μµλ‹λ‹¤.

---

## 2. Analysis Entry Point

λ³µμ›λ μ†μ¤ μ½”λ“ λ¶„μ„ μ‹  
**`public static void StartLoop()` λ£¨ν‹΄λ¶€ν„° ν™•μΈν•μ‹λ©΄ λ©λ‹λ‹¤.**

ν•΄λ‹Ή λ£¨ν‹΄μ„ κΈ°μ¤€μΌλ΅ μ£Όμ” λ™μ‘ νλ¦„κ³Ό  
ν•µμ‹¬ λ΅μ§μ΄ λ‹¨κ³„μ μΌλ΅ νΈμ¶λλ” κµ¬μ΅°λ¥Ό νμ•…ν•  μ μμµλ‹λ‹¤.

ν•΄λ‹Ή μ•…μ„±μ½”λ“μ— λ€ν• **μƒμ„Έ λ¶„μ„ λ³΄κ³ μ„**λ” μ•„λ λ§ν¬μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.

- π”— https://reversingnewbie.tistory.com/44

---



## 3. Background

Agent Teslaλ” λ‹¤μκ³Ό κ°™μ€ κΈ°λ¥μ„ μν–‰ν•©λ‹λ‹¤.

- μ›Ή λΈλΌμ°μ €μ— μ €μ¥λ μ‚¬μ©μ κ³„μ • μ •λ³΄ νƒμ·¨
- μ΄λ©”μΌ λ° FTP ν΄λΌμ΄μ–ΈνΈ μκ²© μ¦λ… μμ§‘
- ν‚¤ μ…λ ¥(Keylogging) κΈ°λ΅
- ν™”λ©΄ μ¤ν¬λ¦°μƒ· μΊ΅μ²
- μμ§‘λ μ •λ³΄μ μ›κ²© μ„λ²„ μ „μ†΅

λΉ„κµμ  λ‹¨μν• κµ¬μ΅°λ¥Ό κ°€μ§€κ³  μμμ—λ„ λ¶κµ¬ν•κ³ ,  
**λ†’μ€ κ°μ—Όλ¥ κ³Ό μ•μ •μ μΈ μ •λ³΄ νƒμ·¨ λ¥λ ¥**μΌλ΅ μΈν•΄ μ¥κΈ°κ°„μ— κ±Έμ³ ν™λ°ν μ‚¬μ©λκ³  μμµλ‹λ‹¤.

---

## 4. Obfuscation Techniques

Agent Teslaμ—λ” λ¶„μ„μ„ λ°©ν•΄ν•κΈ° μ„ν• λ‹¤μ–‘ν• λ‚λ…ν™” κΈ°λ²•μ΄ μ μ©λμ–΄ μμµλ‹λ‹¤.

- **λ¬Έμμ—΄ μ•”νΈν™” (Encrypted Strings)**
- **switchβ€“case κΈ°λ° ν•¨μ νΈμ¶ νλ¦„ λ‚λ…ν™”**
- μλ―Έ μ—†λ” λ¶„κΈ° λ° μ μ–΄ νλ¦„ κµλ€

μ΄λ¬ν• κΈ°λ²•μΌλ΅ μΈν•΄ μ›λ³Έ λ™μ‘ λ΅μ§μ„ μ§κ΄€μ μΌλ΅ νμ•…ν•κΈ° μ–΄λ µμµλ‹λ‹¤.

---

## 5. Project Objective

λ³Έ ν”„λ΅μ νΈμ μ£Όμ” λ©ν‘λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

- λ‚λ…ν™”λ .NET λ°”μ΄λ„λ¦¬ **λ””μ»΄νμΌ**
- μ•”νΈν™”λ λ¬Έμμ—΄μ„ **μ§μ ‘ λ¶„μ„ λ° λ³µνΈν™”**
- switchβ€“case κΈ°λ° νλ¦„μ„ **μ •μƒμ μΈ μ μ–΄ νλ¦„μΌλ΅ λ³µμ›**
- λ¶„μ„μ— μ©μ΄ν• ν•νƒμ **λ³µμ› μ½”λ“(Reconstructed Source Code)** μ κ³µ

μ΄λ¥Ό ν†µν•΄ Agent Teslaμ λ‚΄λ¶€ λ™μ‘μ„ λ³΄λ‹¤ λ…ν™•ν μ΄ν•΄ν•κ³ ,  
**μ•…μ„±μ½”λ“ λ¶„μ„ ν•™μµ λ° λ°©μ–΄ κΈ°μ  μ—°κµ¬**μ— ν™μ©ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.

---

## 6. Project Limitations & Scope

λ³Έ ν”„λ΅μ νΈμ—μ„ μ κ³µλλ” κ²°κ³Όλ¬Όμ€ Agent Tesla μ•…μ„±μ½”λ“μ **μ „μ²΄ κΈ°λ¥μ„ μ™„μ „ν•κ² λ³µμ›ν•κ±°λ‚ λ³µνΈν™”ν• ν•νƒκ°€ μ•„λ‹™λ‹λ‹¤.**

- λ‚λ…ν™” λ° μ•”νΈν™” ν•΄μ λ” **ν•µμ‹¬ λ™μ‘ λ£¨ν‹΄κ³Ό λ¶„μ„μ— ν•„μ”ν• μΌλ¶€ μ½”λ“ μμ—­**μ— ν•μ •λμ–΄ μμµλ‹λ‹¤.
- λ¨λ“  λ¬Έμμ—΄ λ° λ΅μ§μ΄ λ³µμ›λ μƒνƒλ” μ•„λ‹λ©°,  
  μΌλ¶€ μμ—­μ€ μλ„μ μΌλ΅ λ¶„μ„ λ€μƒμ—μ„ μ μ™Έλμ—κ±°λ‚ λ―Έλ³µμ› μƒνƒλ΅ μ μ§€λμ–΄ μμµλ‹λ‹¤.
- μ κ³µλλ” μ½”λ“λ” **λ¶„μ„ λ° ν•™μµ λ©μ μ μ°Έμ΅° μλ£**μ΄λ©°,  
  **μ •μƒμ μΈ λΉλ“ λλ” μ‹¤ν–‰μ΄ λ¶κ°€λ¥ν• μƒνƒ**μ…λ‹λ‹¤.
- μ‹¤μ  μ•…μ„± ν–‰μ„ μ¬ν„, κΈ°λ¥ μ™„μ„±, λ™μ‘ λ³µκµ¬λ¥Ό λ©μ μΌλ΅ ν•μ§€ μ•μµλ‹λ‹¤.

λ³Έ μ €μ¥μ†μ λ©μ μ€ Agent Teslaμ **ν•µμ‹¬ λ™μ‘ κµ¬μ΅°μ™€ λ‚λ…ν™” κΈ°λ²•μ„ μ΄ν•΄ν•κΈ° μ„ν• λ¶„μ„ μλ£ μ κ³µ**μ— μμΌλ©°,  
μ‹¤μ  κ³µκ²© λλ” μ•…μ„±μ½”λ“ μ¬μ‚¬μ©μ„ μλ„ν•μ§€ μ•μµλ‹λ‹¤.

---

